It is straightforward to show that if a matching is stable then it is j-envy-free. A corollary is that if we are given an instance of 3DR-AS in which preferences are binary and symmetric then we can find a j-envy-free matching by finding a stable matching, which, as we showed in Chapter~\ref{c:threed_sr_as}, is bound to exist and can be found in polynomial time (Theorem~\ref{thm:threed_sr_as_symmetric_binary_construction} in Chapter~\ref{c:threed_sr_as}). We state this corollary as Observation~\ref{obs:threed_efr_as_jef_binary_symmetric_from_stability}.

\begin{observation}
\label{obs:threed_efr_as_jef_binary_symmetric_from_stability}
Given an instance of 3DR-AS with binary and symmetric preferences, a j-envy-free matching always exists and can be found in $O(|N|^3)$ time.
\end{observation}

We showed in Chapter~\ref{c:threed_sr_as} that when preferences are binary but not necessarily symmetric, a stable matching need not exist and the associated decision problem is $\NP$-complete. In contrast, we show that a j-envy-free matching is bound to exist and can be found in polynomial time.

\begin{thm}
\label{thm:threed_efr_as_jef_binary_algorithm}
Given an instance of 3DR-AS with binary preferences, a j-envy-free matching must exist and can be found in $O(|N|^3)$ time.
\end{thm}
\begin{proof}
Suppose $(N, V)$ is an instance of 3DR-AS with binary preferences. We describe an $O(|N|^3)$-time algorithm that can construct a j-envy-free matching $M$ in $(N, V)$, as follows.

First, the algorithm constructs from $(N, V)$ another instance $(N, V')$ of 3DR-AS, which has binary and symmetric preferences, by deleting asymmetric arcs.  Next, the algorithm calls Algorithm~\algorithmfont{findStableUW}, shown in Algorithm~\ref{alg:threed_sr_as_approximationalgo}, in Chapter~\ref{c:threed_sr_as}, on the instance $(N, V')$ to construct a matching $M$, which is returned.

Since $(N, V')$ can be constructed in $O(|N|^2)$ time, and the worst-case time complexity of Algorithm~\algorithmfont{findStableUW} is $O(|N|^3)$ (by Theorem~\ref{thm:threed_sr_as_approxratio} in Chapter~\ref{c:threed_sr_as}), the worst-case time complexity of this algorithm is also $O(|N|^3)$. 

It remains to show that $M$ is j-envy-free in $(N, V)$. In the proof, which follows, we refer to the variables and subroutines in Algorithm~\algorithmfont{findStableUW}. We shall also write $v$ in the context of the instance $(N, V')$, which has binary preferences, and write $\mathit{v'}$ in the context of the instance $(N, V)$, which has binary and symmetric preferences. Similarly, we shall use $u'_{\alpha_i}(M)$ to denote $u'_{\alpha_i}(S) = \sum_{{\alpha_j}\in S \setminus \{ \alpha_i \}} \mathit{v'}_{\alpha_i}({\alpha_j})$ for some set of agents $S\subseteq N$.

Note that by the design of Algorithm~\algorithmfont{findStableUW}, $M$ meets the following condition: if there exists a pair of agents $\alpha_i, \alpha_j \in N$ where $\mathit{v'}_{\alpha_i}(\alpha_j) = 1$ and $u'_{\alpha_i}(M)=u'_{\alpha_j}(M)=0$ then no triple contains three agents each with utility $0$ in $M$. 

% the edge j1-j2 is present
For a contradiction, suppose there exists some $\alpha_{i_1}\in N$ where $\alpha_{i_1}$ has j-envy in $M$ for some $\alpha_{j_1}\in N \setminus \{ \alpha_{i_1} \}$. 

Let $M(\alpha_{i_1}) = \{ \alpha_{i_1}, \alpha_{i_2}, \alpha_{i_3} \}$ and $M(\alpha_{j_1}) = \{ \alpha_{j_1}, \alpha_{j_2}, \alpha_{j_3} \}$. Since $\alpha_{i_1}$ has j-envy for $\alpha_{j_1}$ it must be that $u_{\alpha_{i_1}}(\{ \alpha_{j_2}, \alpha_{j_3} \}) > 0$ so either $v_{\alpha_{i_1}}(\alpha_{j_2})=1$, $v_{\alpha_{i_1}}(\alpha_{j_3})=1$, or both. Assume without loss of generality that $v_{\alpha_{i_1}}(\alpha_{j_2})=1$. Note that it must also be that $u_{\alpha_{j_2}}(\{ \alpha_{i_1}, \alpha_{j_3} \}) > u_{\alpha_{j_2}}(M)$ and $u_{\alpha_{j_3}}(\{ \alpha_{i_1}, \alpha_{j_2} \}) > u_{\alpha_{j_3}}(M)$. It follows that $v_{\alpha_{j_2}}(\alpha_{i_1}) > v_{\alpha_{j_2}}(\alpha_{j_1})$ and $v_{\alpha_{j_3}}(\alpha_{i_1}) > v_{\alpha_{j_3}}(\alpha_{j_1})$. Since preferences are binary, it must be that $v_{\alpha_{j_2}}(\alpha_{i_1})=v_{\alpha_{j_3}}(\alpha_{i_1})=1$ and $v_{\alpha_{j_2}}(\alpha_{j_1})=v_{\alpha_{j_3}}(\alpha_{j_1})=0$. It follows by the construction of $(N, V')$ that $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_1})=\mathit{v'}_{\alpha_{j_3}}(\alpha_{j_1})=0$. Since $v_{\alpha_{i_1}}(\alpha_{j_2})=1$ and $v_{\alpha_{j_2}}(\alpha_{i_1})=1$ it also follows that $\mathit{v'}_{\alpha_{i_1}}(\alpha_{j_2})=1$.

We first claim that $\{ \alpha_{j_1}, \alpha_{j_2}, \alpha_{j_3} \} \notin M_1$. Since $v_{\alpha_{j_2}}(\alpha_{j_1})=v_{\alpha_{j_3}}(\alpha_{j_1})=0$, it follows that $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_1})=\mathit{v'}_{\alpha_{j_3}}(\alpha_{j_1})=0$ and thus that $u'_{\alpha_{j_1}}(M_1)=0$. Since $M_1$ is a $P$\nobreakdash-matching, no triple in $M_1$ contains an agent with utility $0$, which shows that $\{ \alpha_{j_1}, \alpha_{j_2}, \alpha_{j_3} \}\notin M_1$ as required. 

Note that it follows that $\{ \alpha_{j_1}, \alpha_{j_2}, \alpha_{j_3} \} \subseteq U$ and thus that $u'_{\alpha_{j_2}}(M_1)=u'_{\alpha_{j_3}}(M_1)=0$.

Next, we claim that $u'_{\alpha_{i_1}}(M)=0$. Since $\alpha_{i_1}$ envies $\alpha_{j_1}$ in $(N, V)$ it must be that $u_{\alpha_{i_1}}(M)<2$ and thus that $u'_{\alpha_{i_1}}(M)<2$. It remains that $u'_{\alpha_{i_1}}(M) \in \{ 0, 1 \}$. Suppose for a contradiction that $u'_{\alpha_{i_1}}(M)=1$ and without loss of generality that $\mathit{v'}_{\alpha_{i_1}}(\alpha_{i_2})=1$. It follows that $v_{\alpha_{i_1}}(\alpha_{i_2})=1$ and thus that $u_{\alpha_{i_1}}(M) \geq 1$. In fact, since $\alpha_{i_1}$ has j-envy for $\alpha_{j_1}$ it must be that $u_{\alpha_{i_1}}(M) = 1$. Moreover, since $u_{\alpha_{i_1}}(\{ \alpha_{j_2}, \alpha_{j_3} \}) > u_{\alpha_{i_1}}(M)=1$, it must be that $v_{\alpha_{i_1}}(\alpha_{j_2})=v_{\alpha_{i_1}}(\alpha_{j_3})=1$. Recall that since $\alpha_{i_1}$ has justified envy for $\alpha_{j_1}$, it must be that $v_{\alpha_{j_2}}(\alpha_{j_1})=v_{\alpha_{j_3}}(\alpha_{j_1})=0$ and $v_{\alpha_{j_2}}(\alpha_{i_1})=v_{\alpha_{j_3}}(\alpha_{i_1})=1$. We have now shown that $\mathit{v'}_{\alpha_{j_2}}(\alpha_{i_1})=\mathit{v'}_{\alpha_{j_3}}(\alpha_{i_1})=1$. Recall our earlier note that $u'_{\alpha_{j_2}}(M_1)=u'_{\alpha_{j_3}}(M_1)=0$. Now, the triple $\{ \alpha_{i_1}, \alpha_{j_2}, \alpha_{j_3} \}$ blocks $M_1$ in $(N, V')$, since $u'_{\alpha_{i_1}}(M_1) = 1 < 2 = u'_{\alpha_{i_1}}(\{ \alpha_{j_2}, \alpha_{j_3} \})$, $u'_{\alpha_{j_2}}(M_1) = 0 < 1 \leq u'_{\alpha_{j_2}}(\{ \alpha_{i_1}, \alpha_{j_3} \})$, and $u'_{\alpha_{j_3}}(M_1) = 0 < 1 \leq u'_{\alpha_{j_3}}(\{ \alpha_{i_1}, \alpha_{j_2} \})$. Since $M_1$ is a stable matching in $(N, V')$, by the correctness of Algorithm~\algorithmfont{findStableUW} (shown in Theorem~\ref{thm:threed_sr_as_approxratio} in Chapter~\ref{c:threed_sr_as}) this is a contradiction. It remains that $u'_{\alpha_{i_1}}(M)=0$, as required.

Note that since $M_1$ is a $P$\nobreakdash-matching and $u'_{\alpha_{i_1}}(M)=0$ it must be that $\alpha_{i_1}$ is unmatched in $M_1$ so $\alpha_{i_1} \in U$.

We finally claim that $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_3})=0$. Suppose for a contradiction that $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_3}) = 1$. We established earlier that $\alpha_{j_1}, \alpha_{j_2}, \alpha_{j_3}$ are unmatched in $M_1$ so $u'_{\alpha_{j_2}}(M_1)=u'_{\alpha_{j_3}}(M_1)=0$. We also established that $u'_{\alpha_{i_1}}(M)=0$ and thus that $u'_{\alpha_{i_1}}(M_1)=0$. Recall also that, by assumption, $\mathit{v'}_{\alpha_{i_1}}(\alpha_{j_2})=1$, so since $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_3})=1$ it now follows that $\{ \alpha_{i_1}, \alpha_{j_2}, \alpha_{j_3} \}$ blocks $M_1$ in $(N, V')$, which is a contradiction since $M_1$ is stable in $(N, V')$. It remains that $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_3})=0$, as required.

Since $\mathit{v'}_{\alpha_{j_1}}(\alpha_{j_3})=0$, $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_1})=0$, and $\mathit{v'}_{\alpha_{j_2}}(\alpha_{j_3})=0$ it follows that $u'_{\alpha_{j_1}}(M)=u'_{\alpha_{j_2}}(M)=u'_{\alpha_{j_3}}(M)=0$. This violates our stated condition on $M$, since there exists a pair of agents $\alpha_{i_1}, \alpha_{j_2} \in N$ where $\mathit{v'}_{\alpha_{i_1}}(\alpha_{j_2})$ and $u'_{\alpha_{i_1}}(M)=u'_{\alpha_{j_2}}(M)=0$, but each agent in the triple $\{ \alpha_{j_1}, \alpha_{j_2}, \alpha_{j_3} \}$ has utility $0$ in $M$, which is a contradiction.
\end{proof}