The \emph{3DR-W Maximally Stable Matching problem} (\mysymbolfirstusedefinition{symboldef:threedr_w_msm}{3DR-W-MSM}) is the following optimisation problem: given an instance of 3DR-W, find a matching with the largest possible number of non-blocking triples. Formally, 3DR-W-MSM is a maximisation problem in which any instance $(N, P)$ of 3DR-W-MSM is also instance of 3DR-W, a solution is a matching in $(N, P)$, and the measure is $|\textrm{nbt}(M, (N, P))|$. We showed in Theorem~\ref{thm:threed_sr_w_existence} that deciding if an instance of 3DR-W contains a matching with $\binom{3n}{3}$ non-blocking triples is $\NP$-complete, so it follows that 3DR-W-MSM is $\NP$-hard. In this section we present a polynomial-time algorithm that can approximate 3DR-W-MSM with an approximation ratio of $9/4$. 

The approximation algorithm is analogous to the corresponding algorithm we presented before for 3DR-B-MSM in Theorem~\ref{thm:threed_sr_b_approxalgofournine} in Chapter~\ref{c:threed_sr_b}. As before, we show that it is possible to construct an instance $(N, P')$ of 3PSA with the same set of agents such that for any matching $M$, if a triple blocks $M$ in $(N, P)$ then it also blocks $M$ in $(N, P')$. We can then show, as before, that the approximation ratio of the algorithm for 3DR-W-MSM is $9/4$.

\begin{thm}
\label{thm:threed_sr_w_approxalgofournine}
There exists a polynomial-time $9/4$-approximation algorithm for 3DR-W-MSM.
\end{thm}
\begin{proof}
The proof is analogous to Theorem~\ref{thm:threed_sr_b_approxalgofournine} in Chapter~\ref{c:threed_sr_b}, except $(N, P')$ is constructed such that for any agent $\alpha_i$, $P'_{\alpha_i}$ is the list of all $2$-agent subsets of $N \setminus \{ \alpha_i \}$ in colexicographic order \cite{combinatorialwest} with respect to $P_{\alpha_i}$. Suppose $M$ is an arbitrary matching in $(N, P)$ and $r$ is a triple that blocks $M$ in $(N, P)$. We will show that $r$ also blocks $M$ in $(N, P')$. For any $\alpha_k$ in $r$ it must be that $\mathscr{W}_{\alpha_k}(r) \succ_{P_{\alpha_k}} \mathscr{W}_{\alpha_k}(M)$. By the construction of $P'_{\alpha_k}$ as the colexicographic order of $P_{\alpha_k}$, it must be that $r \succ_{P'_{\alpha_k}} M(\alpha_k)$ and thus that $r$ also blocks $M$ in $(N, P')$. It follows that $|\textrm{bt}(M, (N, P'))| \geq |\textrm{bt}(M, (N, P))|$ and thus that $|\textrm{nbt}(M, (N, P))| \geq |\textrm{nbt}(M, (N, P'))|$, as required.
\end{proof}